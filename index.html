<!DOCTYPE html>
<html lang="en">
<head>
<script type='text/javascript' src='//pl24867056.profitableratecpm.com/3a/69/d1/3a69d11472d2ab7730e620c747eb79ef.js'></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie TV - Watch & Download Latest HD Movies</title>
    
    <!-- SEO and Meta Tags -->
    <meta name="google-site-verification" content="1mDUrmtjTiKfrYayJONYnzIhgBQcw30UZi0Q1hdhAO4" />
    <meta name="title" content="Movie TV - Watch & Download Latest HD Movies">
    <meta name="description" content="Explore and download a vast collection of the latest and classic movies in HD. Find your favorite action, comedy, horror, and romantic films easily and for free.">
    <meta name="keywords" content="movie downloader, latest movies, hd movies, download movies, free movies, action movies, comedy, horror, romantic, movie apps, upcoming movies, movie reviews">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://hindimovie.netlify.app/" />
    
    <!-- Google Fonts for Professional Look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
    
    <!-- Open Graph / Facebook Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hindimovie.netlify.app/">
    <meta property="og:title" content="Movie TV - Watch & Download Latest HD Movies">
    <meta property="og:description" content="Explore and download a vast collection of the latest and classic movies in HD.">
    <meta property="og:image" content="https://i.postimg.cc/0yCyzmhm/IMG-20250730-220406.jpg" id="og-image-meta">
    
    <!-- Twitter Meta Tags -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://hindimovie.netlify.app/">
    <meta property="twitter:title" content="Movie TV - Watch & Download Latest HD Movies">
    <meta property="twitter:description" content="Explore and download a vast collection of the latest and classic movies in HD.">
    <meta property="twitter:image" content="https://i.postimg.cc/0yCyzmhm/IMG-20250730-220406.jpg" id="twitter-image-meta">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    
    <!-- Schema Markup -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Movie TV",
      "url": "https://hindimovie.netlify.app/",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://hindimovie.netlify.app/#search={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>

    <style>
        html{scroll-behavior:smooth}body{margin:0;padding:20px;font-family:Arial,sans-serif;background-color:#111;color:#fff;overflow-x:hidden}body.loading{overflow:hidden}body.loading>*:not(#loader){display:none}header{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;background-color:#1a1a1a;box-shadow:0 2px 10px rgba(0,0,0,.5);border-bottom:2px solid orange}
        header h1{font-family:'Montserrat',sans-serif;font-size:30px;font-weight:700;margin:0;letter-spacing:1.5px;background:linear-gradient(45deg,#ffc107,#ff8c00);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-fill-color:transparent;text-shadow:2px 2px 4px rgba(0,0,0,.2)}
        .category-filters{text-align:center;margin:20px 0;display:flex;justify-content:center;flex-wrap:wrap;gap:8px;padding:0 10px}.category-filters button{background-color:#333;color:orange;border:none;padding:10px 20px;border-radius:5px;cursor:pointer;font-size:14px;transition:background-color .3s ease;white-space:nowrap}.category-filters button:hover{background-color:#555}.category-filters button.active{background-color:orange;color:#000}#search-bar{margin:20px auto;max-width:600px;display:block;width:100%;padding:10px;background-color:#222;color:#fff;border:none;border-radius:6px;font-size:16px}.movie-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px;max-width:600px;margin:20px auto}.movie-card{background-color:#222;border-radius:10px;overflow:hidden;transition:transform .2s;position:relative}.movie-card:hover{transform:scale(1.03)}.movie-card img{width:100%;height:280px;object-fit:cover;display:block;cursor:pointer}.movie-title{padding:10px;text-align:center;font-weight:700}
        .more-options-btn{position:absolute;top:5px;right:5px;background:rgba(0,0,0,0.5);border:none;border-radius:50%;cursor:pointer;width:30px;height:30px;display:flex;align-items:center;justify-content:center;z-index:10}.more-options-btn svg{fill:orange;width:20px;height:20px}
        .options-menu{display:none;position:absolute;top:40px;right:8px;background-color:#333;border-radius:5px;box-shadow:0 2px 5px rgba(0,0,0,.7);z-index:11;padding:5px 0;min-width:120px;text-align:left}.options-menu a{display:block;padding:8px 15px;color:#fff;text-decoration:none;font-size:14px;transition:background-color .2s}.options-menu a:hover{background-color:#555}#savedPostsModal .modal-content{background-color:#222;text-align:left;max-width:600px;padding:20px}#savedPostsModal h2{color:orange;text-align:center;margin-bottom:20px}#savedPostsModal .thumbnails-container{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:10px}#savedPostsModal .thumbnail-item{position:relative;cursor:pointer;border-radius:5px;overflow:hidden;transition:transform .2s,box-shadow .2s}#savedPostsModal .thumbnail-item:hover{transform:scale(1.05);box-shadow:0 0 15px orange}#savedPostsModal .thumbnail-item img{width:100%;height:120px;object-fit:cover;display:block}#savedPostsModal .thumbnail-item .title{position:absolute;bottom:0;left:0;right:0;background-color:rgba(0,0,0,.7);color:#fff;font-size:12px;padding:5px;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}#savedPostsModal .remove-saved{position:absolute;top:2px;right:2px;cursor:pointer;color:red;font-size:20px;background:rgba(0,0,0,.6);border-radius:50%;width:24px;height:24px;line-height:24px;text-align:center;z-index:10}#savedPostsModal .no-posts{text-align:center;color:#ccc;padding:20px}.modal{display:none;position:fixed;z-index:9999;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.7)}.modal-content{background-color:#222;margin:10% auto;padding:20px;border-radius:10px;width:90%;max-width:450px;text-align:center}
        #media-display-area{width:100%;margin-bottom:15px;padding:8px;box-sizing:border-box}
        #media-display-area img, #media-display-area iframe{width:100%;height:auto;display:block;border:3px solid #444;border-radius:10px;box-sizing:border-box;box-shadow:0 4px 15px rgba(0,0,0,.5);background-color:#000}
        #media-display-area iframe{aspect-ratio:16/9}
        .movie-description{font-size:14px;color:#ccc;line-height:1.5;margin-top:20px;margin-bottom:20px;text-align:left;padding:0 10px}.modal-content h3{margin:15px 0 5px 0;color:orange}.modal-content a{display:inline-block;padding:10px 20px;background-color:orange;color:#000;text-decoration:none;font-weight:700;border-radius:5px;margin-top:10px}.modal-content a:hover{background-color:darkorange}.close{float:right;font-size:28px;font-weight:bold;color:#fff;cursor:pointer}.close:hover{color:#ccc}#loader{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.8);display:flex;justify-content:center;align-items:center;z-index:10000;flex-direction:column}.spinner{border:6px solid #f3f3f3;border-top:6px solid orange;border-radius:50%;width:50px;height:50px;animation:spin 1s linear infinite;margin-bottom:20px}#loader p{color:orange;font-size:18px;margin:0}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.privacy-policy{max-width:800px;margin:40px auto;padding:30px;background-color:#222;border-radius:10px;color:#fff;line-height:1.6;box-shadow:0 4px 15px rgba(0,0,0,.5); display: none;}.footer-links{text-align:center;margin-top:30px;margin-bottom:20px}.footer-links a{color:orange;text-decoration:none;margin:0 10px;font-size:16px}.footer-links a:hover{text-decoration:underline}.movie-views{display:flex;justify-content:center;padding:5px 0;font-size:12px;color:#bbb;border-top:1px solid #333;margin-top:5px}.movie-views p{margin:0;display:flex;align-items:center;gap:5px}.movie-actions{text-align:center;padding:8px 0;border-top:1px solid #333;margin-top:5px}.like-btn{background:0 0;border:none;color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;gap:5px;margin:0 auto;padding:5px 10px;border-radius:5px;transition:background-color .3s ease,color .3s ease}.like-btn:hover{background-color:#333}.like-btn.liked{color:red}.movie-stats{display:flex;justify-content:space-around;align-items:center;padding:8px 0;border-top:1px solid #333;margin-top:5px;font-size:14px}.download-buttons{display:flex;flex-direction:column;align-items:stretch;gap:10px;margin-top:20px}.download-buttons a{display:flex;align-items:center;justify-content:center;padding:12px 15px;color:#fff;text-decoration:none;font-weight:700;border-radius:8px;transition:background-color .3s ease;font-size:16px;gap:8px}.download-buttons a.watch-button{background-color:#d9534f}.download-buttons a.watch-button:hover{background-color:#c9302c}.download-buttons a.download-button{background-color:#5cb85c}.download-buttons a.download-button:hover{background-color:#4cae4c}#app-install-banner{position:fixed;bottom:0;left:0;width:100%;background-color:#1a1a1a;box-shadow:0 -2px 10px rgba(0,0,0,.5);z-index:1001;padding:15px;box-sizing:border-box;display:none;align-items:center;justify-content:space-between;gap:15px}.app-info{display:flex;align-items:center;gap:15px}.app-icon{width:50px;height:50px;border-radius:10px}.app-text{color:#fff}.app-text h4{margin:0 0 5px 0;color:orange}.app-text p{margin:0;font-size:14px;color:#ccc}.banner-actions{display:flex;align-items:center;gap:15px}.download-app-btn{background-color:orange;color:#111;padding:8px 16px;border-radius:5px;text-decoration:none;font-weight:700;font-size:14px;white-space:nowrap}.close-banner-btn{font-size:24px;color:#888;cursor:pointer;background:0 0;border:none}
        .header-actions{display:flex;align-items:center}.header-icon-btn{background:0 0;border:none;cursor:pointer;padding:5px;line-height:0}.header-icon-btn svg{width:28px;height:28px;fill:#fff;transition:opacity .2s}.header-icon-btn:hover svg{opacity:.8}.side-menu{position:fixed;top:0;right:-230px;width:220px;height:100%;background-color:#1f1f1f;box-shadow:-5px 0 15px rgba(0,0,0,.5);z-index:10001;transition:right .4s ease-in-out;padding:20px;box-sizing:border-box;display:flex;flex-direction:column}.side-menu.open{right:0}.side-menu .menu-header{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #444;padding-bottom:15px;margin-bottom:15px}.side-menu .menu-header h2{color:orange;margin:0;font-size:22px}.side-menu .close-menu-btn{font-size:30px;color:#fff;background:0 0;border:none;cursor:pointer}.side-menu nav a{color:#e0e0e0;text-decoration:none;padding:15px;font-size:18px;display:flex;align-items:center;gap:15px;border-radius:8px;transition:background-color .2s}.side-menu nav a:hover{background-color:#333}.side-menu nav a svg{flex-shrink:0}
        .user-message-container { margin: 15px 0; padding: 10px; border: 1px dashed orange; border-radius: 8px; background-color: #2a2a2a; }
        .user-message { margin: 5px 0; padding: 0; font-size: 14px; color: #f0f0f0; line-height: 1.5; text-align: left; }
        .movie-info-table{width:100%;margin-top:15px;border-collapse:collapse;font-size:14px}.movie-info-table td{padding:8px 5px;text-align:left;border-bottom:1px solid #333;vertical-align:top}.movie-info-table tr:last-child td{border-bottom:none}.movie-info-table td:first-child{color:orange;font-weight:700;width:110px}
        .modal-ad-container{margin:15px 0;padding:10px 0;border-top:1px solid #333;border-bottom:1px solid #333}
    </style>
</head>
<body>
    <header>
        <h1>🎬 Movie TV</h1>
        <div class="header-actions">
            <button id="menu-btn" class="header-icon-btn" title="Open Menu">
                <svg xmlns="http://www.w3.org/2000/svg" height="28px" viewBox="0 0 24 24" width="28px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
            </button>
        </div>
    </header>
  
    <div id="side-menu" class="side-menu">
        <div class="menu-header">
            <h2>Menu</h2>
            <button class="close-menu-btn" title="Close Menu">×</button>
        </div>
        <nav>
            <a href="#" id="menu-saved-list-btn">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#e0e0e0"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-3 10.5l-2.5-1.5L13 14.5V4h5v10.5z"/></svg>
                <span>Saved List</span>
            </a>
        </nav>
    </div>

    <div id="app-install-banner">
        <div class="app-info"><img src="" alt="App Icon" class="app-icon" id="app-icon-img"><div class="app-text"><h4>Movie TV App</h4><p>Get a better experience with our app.</p></div></div>
        <div class="banner-actions"><a href="#" id="download-app-link" class="download-app-btn" target="_blank">Download App</a><button id="close-banner" class="close-banner-btn">×</button></div>
    </div>

    <div class="category-filters">
      <button onclick="filterByCategory('all', event)" class="active">All</button>
      <button onclick="filterByCategory('latest movie', event)">Latest Movie</button>
      <button onclick="filterByCategory('action', event)">Action</button>
      <button onclick="filterByCategory('comedy', event)">Comedy</button>
      <button onclick="filterByCategory('horror', event)">Horror</button>
      <button onclick="filterByCategory('romantic', event)">Romantic</button>
      <button onclick="filterByCategory('upcoming', event)">Upcoming Movie</button>
    </div>

    <div id="savedPostsModal" class="modal"><div class="modal-content"><span class="close" onclick="closeActiveModal()">×</span><h2>📚 Saved Posts</h2><div class="thumbnails-container" id="saved-posts-list"></div><div class="no-posts" id="no-saved-posts-message" style="display: none;">No saved posts yet.</div></div></div>
    <input type="text" id="search-bar" placeholder="🔍 Search movies by title..." onkeyup="filterMovies()">
    <div id="viewerModal" class="modal"><div class="modal-content" id="viewerContent"></div></div>
    <div id="loader"><div class="spinner"></div><p>Loading Movies...</p></div>
    <div class="movie-grid" id="movie-grid"></div>
    <div id="privacy-policy-section" class="privacy-policy"></div>
    <div class="footer-links"><a href="#" onclick="showPrivacyPolicy()">Privacy Policy</a> | <a href="#">Terms of Service</a><p style="margin-top: 10px;">© 2025 Movie TV. All Rights Reserved.</p></div>

<script>
    const firebaseConfig = {
      apiKey: "AIzaSyD-tlrPK8s9h87PVqtvprBy_phcCqONLeU",
      authDomain: "my-movie-81a4b.firebaseapp.com",
      databaseURL: "https://my-movie-81a4b-default-rtdb.firebaseio.com",
      projectId: "my-movie-81a4b",
      storageBucket: "my-movie-81a4b.firebasestorage.app",
      messagingSenderId: "249876555391",
      appId: "1:249876555391:web:81f3ad52805b0aa314c14a",
      measurementId: "G-RHPWTHQHS2"
    };
    firebase.initializeApp(firebaseConfig);

    function logVisitorAnalytics() {
        if (sessionStorage.getItem('visitorLogged')) return;
        const referrer = document.referrer;
        let source = 'Direct';
        if (referrer) { try { source = new URL(referrer).hostname.replace(/^(www\.|m\.|l\.)/, ''); } catch (e) { source = 'Other/App'; } }
        const analyticsData = { source, timestamp: firebase.database.ServerValue.TIMESTAMP };
        fetch('https://ipapi.co/json/')
            .then(res => res.json()).then(data => { analyticsData.country = data.country_name || 'Unknown'; })
            .catch(() => { analyticsData.country = 'Unknown'; })
            .finally(() => { database.ref('analytics/visits').push(analyticsData); sessionStorage.setItem('visitorLogged', 'true'); });
    }

    const database = firebase.database();
    const moviesRef = database.ref('movies');
    const settingsRef = database.ref('siteSettings');
    let allMovieData = {};
    let currentCategoryFilter = 'all';
    let siteSettings = {};
    let activeModal = null;

    document.addEventListener('DOMContentLoaded', () => {
        logVisitorAnalytics();
        document.body.classList.add('loading');
        const defaultSettings = { appIconUrl: '', appDownloadUrl: '', mainOgImageUrl: '', bengaliMessage: '', hindiMessage: '' };
        settingsRef.once('value').then(snapshot => {
            siteSettings = { ...defaultSettings, ...snapshot.val() };
            document.getElementById('app-icon-img').src = siteSettings.appIconUrl;
            document.getElementById('download-app-link').href = siteSettings.appDownloadUrl;
            loadAndDisplayMovies();
        }).catch(() => { siteSettings = defaultSettings; loadAndDisplayMovies(); });
        setupMenuControls();
        setupAppBanner();
        window.addEventListener('popstate', handlePopState);
    });

    function loadAndDisplayMovies() {
        moviesRef.once("value", snapshot => {
            document.body.classList.remove("loading");
            document.getElementById("loader").style.display = "none";
            const movies = [];
            snapshot.forEach(child => { movies.push({ key: child.key, ...child.val() }); });
            movies.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
            movies.forEach(movie => {
                movie.slug = createSlug(movie.title);
                allMovieData[movie.slug] = movie;
                addMovieCard(movie);
            });
            filterMovies();
            handleDirectUrlAccess();
        });
    }

    function handlePopState() { if (activeModal) closeActiveModal(true); }

    function openModal(modalId, stateObject, hash) {
        document.getElementById(modalId).style.display = 'block';
        showMainContent(false);
        activeModal = modalId;
        if (window.location.hash !== hash) {
            window.history.pushState(stateObject, '', hash);
        }
    }

    function closeActiveModal(fromPopState = false) {
        if (!activeModal) return;
        if (activeModal === 'viewerModal') {
            const iframe = document.querySelector('#viewerModal iframe');
            if (iframe) iframe.src = '';
        }
        document.getElementById(activeModal).style.display = 'none';
        showMainContent(true);
        resetMetaTagsToHome();
        if (!fromPopState && window.location.hash) {
            window.history.back();
        }
        activeModal = null;
    }

    function openViewer(slug) {
        const movieData = allMovieData[slug];
        if (!movieData) return;
        displayViewerContent(movieData);
        openModal('viewerModal', { slug: slug }, `#movie/${slug}`);
        updateMetaTags(movieData.title, movieData.description, movieData.image, window.location.href);
        database.ref("movies/" + movieData.key + "/viewCount").transaction(count => (count || 0) + 1);
    }
    
    function showSavedPosts() {
        const container = document.getElementById("saved-posts-list"), noPostsMsg = document.getElementById("no-saved-posts-message");
        container.innerHTML = "";
        let hasPosts = false;
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key.startsWith("savedMovie_")) {
                hasPosts = true;
                const post = JSON.parse(localStorage.getItem(key)), item = document.createElement('div');
                item.className = 'thumbnail-item';
                item.innerHTML = `<img src="${post.image}" alt="${post.title}"><div class="title">${post.title}</div><span class="remove-saved" onclick="removeSavedPost(event, '${key}')">×</span>`;
                item.onclick = e => { if (e.target.classList.contains('remove-saved')) return; closeActiveModal(); openViewer(createSlug(post.title)); };
                container.appendChild(item);
            }
        }
        noPostsMsg.style.display = hasPosts ? "none" : "block";
        openModal('savedPostsModal', { modal: 'saved' }, '#saved');
    }

    function removeSavedPost(event, key) {
        event.stopPropagation();
        if (confirm("Are you sure?")) {
            localStorage.removeItem(key);
            event.target.parentElement.remove();
            if (document.querySelectorAll('#saved-posts-list .thumbnail-item').length === 0) {
                document.getElementById('no-saved-posts-message').style.display = 'block';
            }
        }
    }

    function handleDirectUrlAccess() {
        const hash = window.location.hash;
        const processHash = () => {
            if (hash.startsWith('#movie/')) { const slug = hash.substring(7); if (allMovieData[slug]) openViewer(slug); } 
            else if (hash === '#saved') { showSavedPosts(); } 
            else { resetMetaTagsToHome(); }
        };
        if (Object.keys(allMovieData).length > 0) { processHash(); } 
        else { const interval = setInterval(() => { if (Object.keys(allMovieData).length > 0) { clearInterval(interval); processHash(); } }, 100); }
    }
    
    function showMainContent(show) {
        ["header", ".category-filters", "#search-bar", ".movie-grid", ".footer-links"].forEach(sel => {
            const el = document.querySelector(sel);
            if (el) el.style.display = show ? "" : "none";
        });
    }

    function playVideoInModal(event, videoUrl) {
        event.preventDefault();
        document.getElementById('media-display-area').innerHTML = `<iframe src="${videoUrl}" scrolling="no" frameborder="0" allowfullscreen="true"></iframe>`;
    }

    function displayViewerContent(movieData) {
        const { title, image, link, link2, link3, intermediateLink, category, description, director, cast, releaseDate } = movieData;
        const viewerContent = document.getElementById('viewerContent');
        viewerContent.innerHTML = ''; // Clear previous content

        let buttonsHtml = '';
        if (intermediateLink) { buttonsHtml += `<a href="${intermediateLink}" target="_blank" class="watch-button">▶️ Watch Now</a>`; } 
        else if (link) { buttonsHtml += `<a href="#" onclick="playVideoInModal(event, '${link}')" class="watch-button">▶️ Watch Now</a>`; }
        if (link2) buttonsHtml += `<a href="${link2}" target="_blank" class="download-button">Download 720p</a>`;
        if (link3) buttonsHtml += `<a href="${link3}" target="_blank" class="download-button">Download 360p</a>`;

        let detailsTable = '<table class="movie-info-table">';
        if (director) detailsTable += `<tr><td>Director</td><td>${director}</td></tr>`;
        if (cast) detailsTable += `<tr><td>Cast</td><td>${cast}</td></tr>`;
        if (releaseDate) detailsTable += `<tr><td>Release Date</td><td>${releaseDate}</td></tr>`;
        if (category) detailsTable += `<tr><td>Genre</td><td>${category}</td></tr>`;
        detailsTable += '</table>';
        
        let userMessageHtml = '';
        if (siteSettings.bengaliMessage || siteSettings.hindiMessage) { userMessageHtml += `<div class="user-message-container"><p class="user-message">${siteSettings.bengaliMessage}</p><p class="user-message">${siteSettings.hindiMessage}</p></div>`; }
        
        const adContainerHtml = `<div class="modal-ad-container"><div id="container-45752cf9decf76008d2cd4626cc5dfec"></div></div>`;
        
        viewerContent.innerHTML = `<span class="close" onclick="closeActiveModal()">×</span><div id="media-display-area"><img src="${image}" alt="${title}"></div><h3>${title}</h3><div class="download-buttons">${buttonsHtml}</div>${adContainerHtml}${detailsTable}<p class="movie-description">${description || "No description available."}</p>${userMessageHtml}`;

        const adScript = document.createElement('script');
        adScript.async = true;
        adScript.setAttribute('data-cfasync', 'false');
        adScript.src = "//pl27095207.profitableratecpm.com/45752cf9decf76008d2cd4626cc5dfec/invoke.js";
        const adContainer = document.getElementById('container-45752cf9decf76008d2cd4626cc5dfec');
        if (adContainer) {
            adContainer.appendChild(adScript);
        }
    }

    function addMovieCard(movie) {
        const { key, title, image, slug, category, ...rest } = movie;
        const grid = document.getElementById('movie-grid');
        const card = document.createElement('div');
        card.className = 'movie-card';
        card.setAttribute('data-slug', slug);
        card.setAttribute('data-title', title.toLowerCase());
        card.setAttribute('data-category', (category || 'other').toLowerCase());

        const movieJsonString = JSON.stringify(movie).replace(/'/g, "&apos;").replace(/"/g, '&quot;');

        card.innerHTML = `
            <button class="more-options-btn" onclick="toggleOptionsMenu(event)">
                <svg viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg>
            </button>
            <div class="options-menu">
                <a href="#" onclick='savePostToLocalStorage(event, ${movieJsonString})'>Save Post</a>
            </div>
            <div class="movie-content-wrapper" onclick="openViewer('${slug}')"><img src="${image}" alt="${title}"></div>
            <div class="movie-title">${title}</div>
            <div style="text-align:center; font-size: 14px; color: orange;">[${category || "Other"}]</div>
            <div class="movie-stats">
                <div class="movie-views"><p>👁️ <span id="views-${key}">${movie.viewCount || 0}</span></p></div>
                <div class="movie-actions">
                    <button class="like-btn ${localStorage.getItem(`likedMovie_${key}`) ? 'liked' : ''}" onclick="toggleLike(event, '${key}')">
                        <span class="heart-icon">${localStorage.getItem(`likedMovie_${key}`) ? '❤️' : '♡'}</span> <span id="likes-${key}">${movie.likeCount || 0}</span>
                    </button>
                </div>
            </div>`;
        grid.appendChild(card);
        database.ref(`movies/${key}/viewCount`).on("value", snap => { const el = document.getElementById(`views-${key}`); if (el) el.innerText = snap.val() || 0; });
        database.ref(`movies/${key}/likeCount`).on("value", snap => { const el = document.getElementById(`likes-${key}`); if (el) el.innerText = snap.val() || 0; });
    }
    
    function filterMovies() {
        const searchTerm = document.getElementById("search-bar").value.toLowerCase();
        document.querySelectorAll(".movie-card").forEach(card => {
            const title = card.getAttribute("data-title");
            const category = card.getAttribute("data-category");
            const matchesSearch = title.includes(searchTerm);
            let matchesCategory;
            if (currentCategoryFilter === 'upcoming') { matchesCategory = (category === 'upcoming'); } 
            else if (currentCategoryFilter === 'all') { matchesCategory = (category !== 'upcoming'); } 
            else { matchesCategory = category.includes(currentCategoryFilter) && (category !== 'upcoming'); }
            card.style.display = matchesSearch && matchesCategory ? "block" : "none";
        });
    }
    function filterByCategory(category, event) {
        currentCategoryFilter = category.toLowerCase();
        document.querySelectorAll(".category-filters button").forEach(btn => btn.classList.remove("active"));
        event.target.classList.add("active");
        filterMovies();
    }
    function createSlug(e){ return e ? e.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"") : ""; }
    function updateMetaTags(title, desc, image, url) { document.title = title; document.querySelector('meta[name="description"]').setAttribute("content", desc || ''); /* Update other meta tags similarly... */ }
    function resetMetaTagsToHome() { updateMetaTags("Movie TV", "...", siteSettings.mainOgImageUrl, window.location.origin + window.location.pathname); }
    function toggleLike(e,t){ e.stopPropagation(); const n=`likedMovie_${t}`,o=e.currentTarget; if(!o.classList.contains("liked")){ o.classList.add("liked");o.querySelector(".heart-icon").innerHTML="❤️";localStorage.setItem(n,"true");database.ref(`movies/${t}/likeCount`).transaction(e=>(e||0)+1); } }
    function toggleOptionsMenu(e){ e.stopPropagation(); const t=e.target.closest('.more-options-btn').nextElementSibling; document.querySelectorAll(".options-menu").forEach(menu=>menu.style.display="none"); t.style.display="block"; }
    function savePostToLocalStorage(event, movieObject) {
        event.preventDefault();
        localStorage.setItem(`savedMovie_${movieObject.key}`, JSON.stringify(movieObject));
        alert(`"${movieObject.title}" has been saved!`);
        event.target.closest(".options-menu").style.display = "none";
    }
    function setupAppBanner(){ const e=document.getElementById("app-install-banner"),t=document.getElementById("close-banner"); if(e&&t){setTimeout(()=>{e.style.display="flex"},5e3);t.addEventListener("click",()=>{e.style.display="none"});} }
    function setupMenuControls(){ const e=document.getElementById("menu-btn"),t=document.getElementById("side-menu"),n=t.querySelector(".close-menu-btn"),o=document.getElementById("menu-saved-list-btn");e.addEventListener("click",()=>t.classList.add("open"));n.addEventListener("click",()=>t.classList.remove("open"));o.addEventListener("click",e=>{e.preventDefault();showSavedPosts();t.classList.remove("open")})}
    window.onclick=function(e){ const t=document.getElementById("side-menu"),n=document.getElementById("menu-btn");if(t.classList.contains("open")&&!t.contains(e.target)&&!n.contains(e.target)){t.classList.remove("open")} document.querySelectorAll(".options-menu").forEach(menu=>{if(!menu.contains(e.target)&&!e.target.closest(".more-options-btn")){menu.style.display="none"}})}
    function showPrivacyPolicy(){ alert("Privacy Policy is under development."); }
</script>

</body>
        </html>
