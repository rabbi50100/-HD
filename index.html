<!DOCTYPE html>
<html lang="en">
<head>
<script type='text/javascript' src='//pl24867056.profitableratecpm.com/3a/69/d1/3a69d11472d2ab7730e620c747eb79ef.js'></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie TV - Watch & Download Latest HD Movies</title>
    
    <!-- SEO and Meta Tags -->
    <meta name="google-site-verification" content="1mDUrmtjTiKfrYayJONYnzIhgBQcw30UZi0Q1hdhAO4" />
    <meta name="title" content="Movie TV - Watch & Download Latest HD Movies">
    <meta name="description" content="Explore and download a vast collection of the latest and classic movies in HD. Find your favorite action, comedy, horror, and romantic films easily and for free.">
    <meta name="keywords" content="movie downloader, latest movies, hd movies, download movies, free movies, action movies, comedy, horror, romantic, movie apps, upcoming movies, movie reviews">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://hindimovie.netlify.app/" />
    
    <!-- Google Fonts for Professional Look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
    
    <!-- Open Graph / Facebook Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hindimovie.netlify.app/">
    <meta property="og:title" content="Movie TV - Watch & Download Latest HD Movies">
    <meta property="og:description" content="Explore and download a vast collection of the latest and classic movies in HD.">
    <meta property="og:image" content="https://i.postimg.cc/0yCyzmhm/IMG-20250730-220406.jpg" id="og-image-meta">
    
    <!-- Twitter Meta Tags -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://hindimovie.netlify.app/">
    <meta property="twitter:title" content="Movie TV - Watch & Download Latest HD Movies">
    <meta property="twitter:description" content="Explore and download a vast collection of the latest and classic movies in HD.">
    <meta property="twitter:image" content="https://i.postimg.cc/0yCyzmhm/IMG-20250730-220406.jpg" id="twitter-image-meta">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    
    <!-- Schema Markup -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Movie TV",
      "url": "https://hindimovie.netlify.app/",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://hindimovie.netlify.app/#search={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>

    <style>
        html{scroll-behavior:smooth}body{margin:0;padding:20px;font-family:Arial,sans-serif;background-color:#111;color:#fff;overflow-x:hidden}body.loading{overflow:hidden}body.loading>*:not(#loader){display:none}header{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;background-color:#1a1a1a;box-shadow:0 2px 10px rgba(0,0,0,.5);border-bottom:2px solid orange}
        header h1{font-family:'Montserrat',sans-serif;font-size:30px;font-weight:700;margin:0;letter-spacing:1.5px;background:linear-gradient(45deg,#ffc107,#ff8c00);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-fill-color:transparent;text-shadow:2px 2px 4px rgba(0,0,0,.2)}
        .category-filters{text-align:center;margin:20px 0;display:flex;justify-content:center;flex-wrap:wrap;gap:8px;padding:0 10px}.category-filters button{background-color:#333;color:orange;border:none;padding:10px 20px;border-radius:5px;cursor:pointer;font-size:14px;transition:background-color .3s ease;white-space:nowrap}.category-filters button:hover{background-color:#555}.category-filters button.active{background-color:orange;color:#000}#search-bar{margin:20px auto;max-width:600px;display:block;width:100%;padding:10px;background-color:#222;color:#fff;border:none;border-radius:6px;font-size:16px}.movie-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px;max-width:600px;margin:20px auto}.movie-card{background-color:#222;border-radius:10px;overflow:hidden;transition:transform .2s;position:relative}.movie-card:hover{transform:scale(1.03)}.movie-card img{width:100%;height:280px;object-fit:cover;display:block;cursor:pointer}.movie-title{padding:10px;text-align:center;font-weight:700}.more-options-btn{position:absolute;top:8px;right:8px;font-size:24px;cursor:pointer;color:orange;background:0 0;border:none;padding:2px 8px;line-height:1;z-index:10}.options-menu{display:none;position:absolute;top:35px;right:8px;background-color:#333;border-radius:5px;box-shadow:0 2px 5px rgba(0,0,0,.7);z-index:11;padding:5px 0;min-width:120px;text-align:left}.options-menu a{display:block;padding:8px 15px;color:#fff;text-decoration:none;font-size:14px;transition:background-color .2s}.options-menu a:hover{background-color:#555}#savedPostsModal .modal-content{background-color:#222;text-align:left;max-width:600px;padding:20px}#savedPostsModal h2{color:orange;text-align:center;margin-bottom:20px}#savedPostsModal .thumbnails-container{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:10px}#savedPostsModal .thumbnail-item{position:relative;cursor:pointer;border-radius:5px;overflow:hidden;transition:transform .2s,box-shadow .2s}#savedPostsModal .thumbnail-item:hover{transform:scale(1.05);box-shadow:0 0 15px orange}#savedPostsModal .thumbnail-item img{width:100%;height:120px;object-fit:cover;display:block}#savedPostsModal .thumbnail-item .title{position:absolute;bottom:0;left:0;right:0;background-color:rgba(0,0,0,.7);color:#fff;font-size:12px;padding:5px;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}#savedPostsModal .remove-saved{position:absolute;top:2px;right:2px;cursor:pointer;color:red;font-size:18px;background:rgba(0,0,0,.5);border-radius:50%;width:22px;height:22px;line-height:22px;text-align:center;z-index:10}#savedPostsModal .no-posts{text-align:center;color:#ccc;padding:20px}.modal{display:none;position:fixed;z-index:9999;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.7)}.modal-content{background-color:#222;margin:10% auto;padding:20px;border-radius:10px;width:90%;max-width:450px;text-align:center}.modal-content img{max-width:250px;height:auto;border-radius:10px;display:block;margin:0 auto 15px}.movie-details p{color:#aaa;margin:5px 0;font-size:14px;text-align:left;padding:0 10px}.movie-details strong{color:orange}.movie-description{font-size:14px;color:#ccc;line-height:1.5;margin-top:10px;margin-bottom:20px;text-align:left;padding:0 10px}.modal-content h3{margin:15px 0;color:orange}.modal-content a{display:inline-block;padding:10px 20px;background-color:orange;color:#000;text-decoration:none;font-weight:700;border-radius:5px;margin-top:10px}.modal-content a:hover{background-color:darkorange}.close{float:right;font-size:28px;font-weight:bold;color:#fff;cursor:pointer}.close:hover{color:#ccc}#loader{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.8);display:flex;justify-content:center;align-items:center;z-index:10000;flex-direction:column}.spinner{border:6px solid #f3f3f3;border-top:6px solid orange;border-radius:50%;width:50px;height:50px;animation:spin 1s linear infinite;margin-bottom:20px}#loader p{color:orange;font-size:18px;margin:0}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.privacy-policy{max-width:800px;margin:40px auto;padding:30px;background-color:#222;border-radius:10px;color:#fff;line-height:1.6;box-shadow:0 4px 15px rgba(0,0,0,.5); display: none;}.footer-links{text-align:center;margin-top:30px;margin-bottom:20px}.footer-links a{color:orange;text-decoration:none;margin:0 10px;font-size:16px}.footer-links a:hover{text-decoration:underline}.movie-views{display:flex;justify-content:center;padding:5px 0;font-size:12px;color:#bbb;border-top:1px solid #333;margin-top:5px}.movie-views p{margin:0;display:flex;align-items:center;gap:5px}.movie-actions{text-align:center;padding:8px 0;border-top:1px solid #333;margin-top:5px}.like-btn{background:0 0;border:none;color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;gap:5px;margin:0 auto;padding:5px 10px;border-radius:5px;transition:background-color .3s ease,color .3s ease}.like-btn:hover{background-color:#333}.like-btn.liked{color:red}.movie-stats{display:flex;justify-content:space-around;align-items:center;padding:8px 0;border-top:1px solid #333;margin-top:5px;font-size:14px}.download-buttons{display:flex;flex-direction:column;align-items:stretch;gap:10px;margin-top:20px}.download-buttons a{display:flex;align-items:center;justify-content:center;padding:12px 15px;color:#fff;text-decoration:none;font-weight:700;border-radius:8px;transition:background-color .3s ease;font-size:16px;gap:8px}.download-buttons a.watch-button{background-color:#d9534f}.download-buttons a.watch-button:hover{background-color:#c9302c}.download-buttons a.download-button{background-color:#5cb85c}.download-buttons a.download-button:hover{background-color:#4cae4c}#app-install-banner{position:fixed;bottom:0;left:0;width:100%;background-color:#1a1a1a;box-shadow:0 -2px 10px rgba(0,0,0,.5);z-index:1001;padding:15px;box-sizing:border-box;display:none;align-items:center;justify-content:space-between;gap:15px}.app-info{display:flex;align-items:center;gap:15px}.app-icon{width:50px;height:50px;border-radius:10px}.app-text{color:#fff}.app-text h4{margin:0 0 5px 0;color:orange}.app-text p{margin:0;font-size:14px;color:#ccc}.banner-actions{display:flex;align-items:center;gap:15px}.download-app-btn{background-color:orange;color:#111;padding:8px 16px;border-radius:5px;text-decoration:none;font-weight:700;font-size:14px;white-space:nowrap}.close-banner-btn{font-size:24px;color:#888;cursor:pointer;background:0 0;border:none}
        .header-actions{display:flex;align-items:center}.header-icon-btn{background:0 0;border:none;cursor:pointer;padding:5px;line-height:0}.header-icon-btn svg{width:28px;height:28px;fill:#fff;transition:opacity .2s}.header-icon-btn:hover svg{opacity:.8}.side-menu{position:fixed;top:0;right:-230px;width:220px;height:100%;background-color:#1f1f1f;box-shadow:-5px 0 15px rgba(0,0,0,.5);z-index:10001;transition:right .4s ease-in-out;padding:20px;box-sizing:border-box;display:flex;flex-direction:column}.side-menu.open{right:0}.side-menu .menu-header{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #444;padding-bottom:15px;margin-bottom:15px}.side-menu .menu-header h2{color:orange;margin:0;font-size:22px}.side-menu .close-menu-btn{font-size:30px;color:#fff;background:0 0;border:none;cursor:pointer}.side-menu nav a{color:#e0e0e0;text-decoration:none;padding:15px;font-size:18px;display:flex;align-items:center;gap:15px;border-radius:8px;transition:background-color .2s}.side-menu nav a:hover{background-color:#333}.side-menu nav a svg{flex-shrink:0}
        .user-message-container { margin: 15px 0; padding: 10px; border: 1px dashed orange; border-radius: 8px; background-color: #2a2a2a; }
        .user-message { margin: 5px 0; padding: 0; font-size: 14px; color: #f0f0f0; line-height: 1.5; text-align: left; }
    </style>
</head>
<body>
    <header>
        <h1>🎬 Movie TV</h1>
        <div class="header-actions">
            <button id="menu-btn" class="header-icon-btn" title="Open Menu">
                <svg xmlns="http://www.w3.org/2000/svg" height="28px" viewBox="0 0 24 24" width="28px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
            </button>
        </div>
    </header>
  
    <div id="side-menu" class="side-menu">
        <div class="menu-header">
            <h2>Menu</h2>
            <button class="close-menu-btn" title="Close Menu">×</button>
        </div>
        <nav>
            <a href="#" id="menu-saved-list-btn">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#e0e0e0"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-3 10.5l-2.5-1.5L13 14.5V4h5v10.5z"/></svg>
                <span>Saved List</span>
            </a>
        </nav>
    </div>

    <div id="app-install-banner">
        <div class="app-info"><img src="" alt="App Icon" class="app-icon" id="app-icon-img"><div class="app-text"><h4>Movie TV App</h4><p>Get a better experience with our app.</p></div></div>
        <div class="banner-actions"><a href="#" id="download-app-link" class="download-app-btn" target="_blank">Download App</a><button id="close-banner" class="close-banner-btn">×</button></div>
    </div>

    <div class="category-filters">
      <button onclick="filterByCategory('all', event)" class="active">All</button>
      <button onclick="filterByCategory('latest movie', event)">Latest Movie</button>
      <button onclick="filterByCategory('action', event)">Action</button>
      <button onclick="filterByCategory('comedy', event)">Comedy</button>
      <button onclick="filterByCategory('horror', event)">Horror</button>
      <button onclick="filterByCategory('romantic', event)">Romantic</button>
      <button onclick="filterByCategory('upcoming', event)">Upcoming Movie</button>
    </div>

    <div id="savedPostsModal" class="modal"><div class="modal-content"><span class="close" onclick="closeModal('savedPostsModal')">×</span><h2>📚 Saved Posts</h2><div class="thumbnails-container" id="saved-posts-list"></div><div class="no-posts" id="no-saved-posts-message" style="display: none;">No saved posts yet.</div></div></div>
    <input type="text" id="search-bar" placeholder="🔍 Search movies by title..." onkeyup="filterMovies()">
    <div id="viewerModal" class="modal"><div class="modal-content" id="viewerContent"></div></div>
    <div id="loader"><div class="spinner"></div><p>Loading Movies...</p></div>
    <div class="movie-grid" id="movie-grid"></div>
    <div id="privacy-policy-section" class="privacy-policy"></div>
    <div class="footer-links"><a href="#" onclick="showPrivacyPolicy(event)">Privacy Policy</a> | <a href="#">Terms of Service</a><p style="margin-top: 10px;">© 2025 Movie TV. All Rights Reserved.</p></div>

<script>
    const firebaseConfig = {
      apiKey: "AIzaSyD-tlrPK8s9h87PVqtvprBy_phcCqONLeU",
      authDomain: "my-movie-81a4b.firebaseapp.com",
      databaseURL: "https://my-movie-81a4b-default-rtdb.firebaseio.com",
      projectId: "my-movie-81a4b",
      storageBucket: "my-movie-81a4b.firebasestorage.app",
      messagingSenderId: "249876555391",
      appId: "1:249876555391:web:81f3ad52805b0aa314c14a",
      measurementId: "G-RHPWTHQHS2"
    };
    firebase.initializeApp(firebaseConfig);

    //============== নতুন ট্র্যাকিং কোড শুরু ==============//
    function logVisitorAnalytics() {
        if (sessionStorage.getItem('visitorLogged')) { return; }
        fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const referrer = document.referrer;
                let source = 'Direct';
                if (referrer.includes('facebook.com')) {
                    source = 'Facebook';
                } else if (referrer.includes('google.com')) {
                    source = 'Google';
                } else if (referrer) {
                    source = 'Other';
                }
                const analyticsData = {
                    country: data.country_name || 'Unknown',
                    source: source,
                    timestamp: firebase.database.ServerValue.TIMESTAMP
                };
                database.ref('analytics/visits').push(analyticsData);
                sessionStorage.setItem('visitorLogged', 'true');
            }).catch(error => { console.error('Error fetching visitor location:', error); });
    }
    //============== নতুন ট্র্যাকিং কোড শেষ ==============//


    const database = firebase.database();
    const moviesRef = database.ref('movies');
    const settingsRef = database.ref('siteSettings');

    let allMovieData = {};
    let currentCategoryFilter = 'all';
    let lastClickedMovieSlug = null;
    let siteSettings = {};

    document.addEventListener('DOMContentLoaded', () => {
        // নতুন ট্র্যাকিং ফাংশন চালু করা হচ্ছে
        logVisitorAnalytics();

        document.body.classList.add('loading');
        
        const defaultSettings = {
            appIconUrl: 'https://i.ibb.co/6gT26t3/og-image.jpg',
            appDownloadUrl: '#',
            mainOgImageUrl: 'https://i.ibb.co/6gT26t3/og-image.jpg',
            bengaliMessage: '',
            hindiMessage: ''
        };

        settingsRef.once('value').then(settingsSnapshot => {
            siteSettings = { ...defaultSettings, ...settingsSnapshot.val() };
            document.getElementById('app-icon-img').src = siteSettings.appIconUrl;
            document.getElementById('download-app-link').href = siteSettings.appDownloadUrl;
            
            resetMetaTagsToHome();
            setupAppBanner();
            loadAndDisplayMovies();
        }).catch(error => {
            console.error("Error fetching settings:", error);
            siteSettings = defaultSettings;
            resetMetaTagsToHome();
            setupAppBanner();
            loadAndDisplayMovies();
        });

        setupMenuControls();
    });
    
    // বাকি সব কোড অপরিবর্তিত
    function setupAppBanner() {
        const installBanner = document.getElementById('app-install-banner');
        const closeBannerBtn = document.getElementById('close-banner');
        if (installBanner && closeBannerBtn) {
            setTimeout(() => { installBanner.style.display = 'flex'; }, 5000);
            closeBannerBtn.addEventListener('click', () => { installBanner.style.display = 'none'; });
        }
    }
    function setupMenuControls() {
        const menuBtn = document.getElementById('menu-btn');
        const sideMenu = document.getElementById('side-menu');
        const closeMenuBtn = sideMenu.querySelector('.close-menu-btn');
        const menuSavedListBtn = document.getElementById('menu-saved-list-btn');
        menuBtn.addEventListener('click', () => sideMenu.classList.add('open'));
        closeMenuBtn.addEventListener('click', () => sideMenu.classList.remove('open'));
        menuSavedListBtn.addEventListener('click', (e) => {
            e.preventDefault();
            showSavedPosts();
            sideMenu.classList.remove('open');
        });
    }
    function showMainContent(shouldShow) {
        document.querySelector('header').style.display = shouldShow ? 'flex' : 'none';
        document.querySelector('.category-filters').style.display = shouldShow ? 'flex' : 'none';
        document.querySelector('#search-bar').style.display = shouldShow ? 'block' : 'none';
        document.querySelector('.movie-grid').style.display = shouldShow ? 'grid' : 'none';
        document.querySelector('.footer-links').style.display = shouldShow ? 'block' : 'none';
        document.getElementById('privacy-policy-section').style.display = 'none';
    }
    function closeModal(modalId) {
        document.getElementById(modalId).style.display = "none";
        showMainContent(true);
        if (modalId === 'viewerModal') {
            if (lastClickedMovieSlug) {
                const cardToScrollTo = document.querySelector(`.movie-card[data-slug='${lastClickedMovieSlug}']`);
                if (cardToScrollTo) {
                    cardToScrollTo.scrollIntoView({ behavior: "smooth", block: "center" });
                }
                lastClickedMovieSlug = null;
            }
            window.history.pushState({}, "", "/");
            resetMetaTagsToHome();
        }
    }
    function showSavedPosts() {
        const modal = document.getElementById('savedPostsModal');
        const container = document.getElementById('saved-posts-list');
        const noPostsMsg = document.getElementById('no-saved-posts-message');
        container.innerHTML = '';
        let hasPosts = false;
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key.startsWith("savedMovie_")) {
                hasPosts = true;
                const item = JSON.parse(localStorage.getItem(key));
                const thumb = document.createElement("div");
                thumb.className = "thumbnail-item";
                thumb.innerHTML = `<img src="${item.image}" alt="${item.title}"><div class="title">${item.title}</div><span class="remove-saved" onclick="removeSavedPost(event, '${key}')">×</span>`;
                thumb.onclick = () => {
                    closeModal('savedPostsModal');
                    openViewer(createSlug(item.title));
                };
                container.appendChild(thumb);
            }
        }
        noPostsMsg.style.display = hasPosts ? "none" : "block";
        container.style.display = hasPosts ? "grid" : "none";
        showMainContent(false);
        modal.style.display = "block";
    }
    function loadAndDisplayMovies() {
        moviesRef.once('value', snapshot => {
            document.body.classList.remove('loading');
            document.getElementById('loader').style.display = 'none';
            const moviesArray = [];
            snapshot.forEach(child => {
                moviesArray.push({ key: child.key, ...child.val() });
            });
            moviesArray.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
            
            moviesArray.forEach(item => {
                item.slug = createSlug(item.title);
                allMovieData[item.slug] = item;
                addMovieCard(item);
            });
            
            filterMovies();
            handleDirectUrlAccess();
        });
    }
    function resetMetaTagsToHome() {
        const homeTitle = "Movie TV - Watch & Download Latest HD Movies";
        const homeDesc = "Explore and download a vast collection of the latest and classic movies in HD.";
        const homeUrl = window.location.origin + '/';
        updateMetaTags(homeTitle, homeDesc, siteSettings.mainOgImageUrl, homeUrl);
    }
    function updateMetaTags(title, desc, imageUrl, url) {
        document.title = title;
        document.querySelector('meta[name="title"]').setAttribute('content', title);
        document.querySelector('meta[name="description"]').setAttribute('content', desc);
        document.querySelector('link[rel="canonical"]').setAttribute('href', url);
        document.querySelector('meta[property="og:title"]').setAttribute('content', title);
        document.querySelector('meta[property="og:description"]').setAttribute('content', desc);
        document.getElementById('og-image-meta').setAttribute('content', imageUrl);
        document.querySelector('meta[property="og:url"]').setAttribute('content', url);
        document.querySelector('meta[property="twitter:title"]').setAttribute('content', title);
        document.querySelector('meta[property="twitter:description"]').setAttribute('content', desc);
        document.getElementById('twitter-image-meta').setAttribute('content', imageUrl);
        document.querySelector('meta[property="twitter:url"]').setAttribute('content', url);
    }
    function createSlug(t){return t?t.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""):""}
    function escapeQuotes(t){return"string"!=typeof t?"":t.replace(/'/g,"\\'").replace(/"/g,'\\"')}
    function addMovieCard(t) {
        const {key:e, title:a, image:o, slug:n, category:s, viewCount:i, likeCount:r} = t;
        const d = document.createElement("div");
        d.className="movie-card"; d.setAttribute("data-key",e); d.setAttribute("data-title",a.toLowerCase()); d.setAttribute("data-category",(s||"other").toLowerCase()); d.setAttribute("data-slug",n);
        d.innerHTML = `<button class="more-options-btn" onclick="toggleOptionsMenu(event)">…</button><div class="options-menu" id="options-menu-${e}"><a href="#" onclick="savePostToLocalStorage(event, '${e}', '${escapeQuotes(a)}', '${escapeQuotes(o)}', '${escapeQuotes(t.link)}', '${escapeQuotes(t.link2)}', '${escapeQuotes(t.link3)}', '${escapeQuotes(s)}')">Save Post</a></div><div class="movie-content-wrapper"><img src="${o}" alt="${a}"></div><div class="movie-title">${a}</div><div style="text-align:center; font-size: 14px; color: orange;">[${s||"Other"}]</div><div class="movie-stats"><div class="movie-views"><p>👁️ <span id="views-${e}">${i||0}</span></p></div><div class="movie-actions"><button class="like-btn" title="Like Movie" onclick="toggleLike(event, '${e}')"><span class="heart-icon">♡</span> <span id="likes-${e}">${r||0}</span></button></div></div>`;
        const likeButton = d.querySelector('.like-btn'), heartIcon = likeButton.querySelector('.heart-icon');
        if (localStorage.getItem(`likedMovie_${e}`)) { likeButton.classList.add('liked'); heartIcon.innerHTML = '❤️'; }
        d.querySelector(".movie-content-wrapper").addEventListener("click",()=>{ lastClickedMovieSlug = n; openViewer(n); });
        document.getElementById("movie-grid").appendChild(d);
        database.ref(`movies/${e}/viewCount`).on('value', snap => { const viewsSpan = document.getElementById(`views-${e}`); if (viewsSpan) viewsSpan.innerText = snap.val() || 0; });
        database.ref(`movies/${e}/likeCount`).on('value', snap => { const likesSpan = document.getElementById(`likes-${e}`); if (likesSpan) likesSpan.innerText = snap.val() || 0; });
    }
    function handleDirectUrlAccess(){
        const path = window.location.pathname;
        if(path.startsWith("/movie/")){
            const slug = path.substring(7);
            if(allMovieData[slug]){
                openViewer(slug, true);
            } else {
                window.history.replaceState({}, "", "/");
                resetMetaTagsToHome();
            }
        }
    }
    function openViewer(slug, isDirectLoad = false) {
        const movieData = allMovieData[slug];
        if (!movieData) { return; }
        const { key, title, image, link, link2, link3, category, description, director, cast, releaseDate } = movieData;
        let messagesHTML = '';
        if (siteSettings.bengaliMessage || siteSettings.hindiMessage) {
            messagesHTML += `<div class="user-message-container">${siteSettings.bengaliMessage ? `<p class="user-message">${siteSettings.bengaliMessage}</p>` : ''}${siteSettings.hindiMessage ? `<p class="user-message">${siteSettings.hindiMessage}</p>` : ''}</div>`;
        }
        let buttonsHTML = "";
        if (link) buttonsHTML += `<a href="${link}" target="_blank" class="watch-button">▶️ Watch Now</a>`;
        if (link2) buttonsHTML += `<a href="${link2}" target="_blank" class="download-button">Watch 720p</a>`;
        if (link3) buttonsHTML += `<a href="${link3}" target="_blank" class="download-button">Watch 360p</a>`;
        buttonsHTML += `<a href="#" id="share-btn" class="download-button" style="background-color:#007bff; display: flex; align-items: center; justify-content: center; gap: 8px;"><svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 24 24" width="20px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3s3-1.34 3-3-1.34-3-3-3z"/></svg><span>Share</span></a>`;
        const viewerContent = document.getElementById("viewerContent");
        viewerContent.innerHTML = `<span class="close" onclick="closeModal('viewerModal')">×</span><img src="${image}" alt="${title}"><h3>${title}</h3><div class="movie-details">${director ? `<p><strong>Director:</strong> ${director}</p>` : ''}${cast ? `<p><strong>Cast:</strong> ${cast}</p>` : ''}${releaseDate ? `<p><strong>Release Date:</strong> ${releaseDate}</p>` : ''}<p><strong>Genre:</strong> ${category || "N/A"}</p></div><p class="movie-description">${description || "No description available."}</p>${messagesHTML}<div class="download-buttons">${buttonsHTML}</div>`;
        showMainContent(false);
        document.getElementById('viewerModal').style.display = "block";
        const movieUrl = `${window.location.origin}/movie/${slug}`;
        const shareTitle = `${title}`;
        const shareDescription = "Watch & Download Latest HD Movies";
        window.history.pushState({ slug: slug }, shareTitle, movieUrl);
        updateMetaTags(shareTitle, shareDescription, image, movieUrl);
        if (!isDirectLoad) { 
            database.ref('movies/' + key + '/viewCount').transaction(currentViews => (currentViews || 0) + 1);
        }
        document.getElementById('share-btn')?.addEventListener('click', (event) => {
            event.preventDefault();
            if (navigator.share) {
                navigator.share({ title: title, text: shareDescription, url: window.location.href });
            } else {
                navigator.clipboard.writeText(window.location.href).then(() => alert('Share link copied to clipboard!'));
            }
        });
    }
    function filterMovies() {
        const searchQuery = document.getElementById("search-bar").value.toLowerCase();
        document.querySelectorAll('.movie-card').forEach(card => {
            const title = card.getAttribute("data-title");
            const category = card.getAttribute("data-category");
            const isSearchMatch = title.includes(searchQuery);
            let isCategoryMatch;
            if (currentCategoryFilter === 'upcoming') {
                isCategoryMatch = (category === 'upcoming');
            } else if (currentCategoryFilter === 'all') {
                isCategoryMatch = (category !== 'upcoming');
            } else {
                isCategoryMatch = (category.includes(currentCategoryFilter) && category !== 'upcoming');
            }
            card.style.display = isSearchMatch && isCategoryMatch ? "block" : "none";
        });
    }
    function filterByCategory(category, event) {
        currentCategoryFilter = category.toLowerCase();
        document.querySelectorAll(".category-filters button").forEach(button => button.classList.remove("active"));
        event.target.classList.add("active");
        filterMovies();
    }
    window.onclick=function(t){if(t.target.classList.contains("modal"))closeModal(t.target.id); const e=document.getElementById('side-menu'),a=document.getElementById('menu-btn');if(e.classList.contains('open')&&!e.contains(t.target)&&!a.contains(t.target))e.classList.remove('open');document.querySelectorAll(".options-menu").forEach(e=>{if(e.style.display==='block'&&!e.contains(t.target)&&!t.target.classList.contains("more-options-btn"))e.style.display="none"})}
    window.onpopstate=function(event){closeModal('viewerModal');};
    function toggleLike(t,e){t.stopPropagation();const o=`likedMovie_${e}`,n=t.currentTarget;if(!n.classList.contains("liked")){n.classList.add("liked");const t=n.querySelector(".heart-icon");t&&(t.innerHTML="❤️"),localStorage.setItem(o,"true"),database.ref(`movies/${e}/likeCount`).transaction(t=>(t||0)+1)}}
    function toggleOptionsMenu(t){t.stopPropagation();const e=t.target.nextElementSibling,o="block"===e.style.display;document.querySelectorAll(".options-menu").forEach(t=>t.style.display="none"),e.style.display=o?"none":"block"}
    function savePostToLocalStorage(t,e,o,n,s,a,i,l){t.preventDefault();const c={key:e,title:o,image:n,link:s,link2:a,link3:i,category:l};localStorage.setItem(`savedMovie_${e}`,JSON.stringify(c)),alert(`"${o}" has been saved!`),t.target.closest(".options-menu").style.display="none"}
    function removeSavedPost(t,e){t.stopPropagation(),confirm("Are you sure you want to remove this post?")&&(localStorage.removeItem(e),t.target.parentElement.remove())}
    function showPrivacyPolicy(t){t.preventDefault();const e=document.getElementById("privacy-policy-section");e&&(e.innerHTML='<h2>Privacy Policy</h2><p>Your privacy is important to us. This is a sample policy.</p><button onclick="closeModal(\'privacy-policy-section\')">Close</button>',showMainContent(!1),e.style.display="block")}
</script>

</body>
                                  </html>
